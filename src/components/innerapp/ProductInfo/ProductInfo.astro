---
import { Image } from 'astro:assets';
import type { TProduct } from '@/shared/types/product';
import LineBreak from '../LineBreak/LineBreak.astro';
import TextBlock from '../TextBlock/TextBlock.astro';

import ShareIcon from '@/assets/icons/inner-app/share.svg';
import StarIcon from '@/assets/icons/inner-app/star.svg';
import CircleCheckIcon from '@/assets/icons/inner-app/circle-check.svg';
import DotsIcon from '@/assets/icons/inner-app/dots.svg';
import ThumbOffIcon from '@/assets/icons/inner-app/thumb-off.png';

import { colorsCircle } from '@/utils/colorsCircle';
import { checkTypeImg } from '../../../utils/checkTypeImg';

type ColorKey = 'blue' | 'green' | 'yellow';

const { product } = Astro.props as { product: TProduct };
const { color } = colorsCircle[product.colorCircle as ColorKey];
---

<main class="max-w-2xl mx-auto p-4 text-sm text-[#111a05] font-poppins">
  <!-- Галерея -->
  <div class="relative">
    <img src={checkTypeImg(product.imageUrl)} alt={product.title} width={225} height={225} class="mx-auto" />
    <ShareIcon class="absolute bottom-0 right-3 cursor-pointer" />
    <div class={`absolute left-4 top-4 rounded-full size-5 ${color}`} />
  </div>

  <LineBreak />

  <!-- Рейтинг -->
  <div class="flex items-center gap-5">
    <div class="flex gap-1 text-[#fac529]">
      {Array(5).fill(0).map(() => (
        <StarIcon class="size-4 fill-[#fffc00]" />
      ))}
    </div>
    <p>{product.soldCount} {product.rating.soldCountTitle}</p>
  </div>

  <!-- Название и цена -->
  <div class="flex justify-between items-start my-5 gap-2">
    <div class="flex flex-col gap-2 max-w-[70%]">
      <h2 class="font-semibold text-[15px] leading-[110%]">
        {product.title} {product.nameAndPrice.titleOther}
      </h2>
      <p>{product.nameAndPrice.subPrice} {product.newPrice}</p>
    </div>

    <div class="min-w-[130px] flex flex-col gap-3">
      <div class="flex items-center gap-1">
        <Image src={product.nameAndPrice.advantages.advantage1.icon} alt="Advantage Icon" width={20} height={20}/> <span>{product.nameAndPrice.advantages.advantage1.title}</span>
      </div>
      <div class="flex items-center gap-1">
        <Image src={product.nameAndPrice.advantages.advantage2.icon} alt="Advantage Icon" width={20} height={20}/> <span>{product.nameAndPrice.advantages.advantage2.title}</span>
      </div>
    </div>
  </div>

  <!-- Описание -->
  <TextBlock title={product.description.block1.title} description={product.description.block1.text} />
  <TextBlock title={product.description.block2.title} description={product.description.block2.text} />
  <TextBlock title={product.description.block3.title} description={product.description.block3.text} />
  <TextBlock title={product.description.block4.title} description={product.description.block4.text} />

  <!-- Примечания -->
  <div class="flex flex-col gap-4 my-4">
    <h3 class="font-semibold">{product.notes.title}</h3>
    <p class="italic">{product.notes.text1}</p>
    <p class="italic">{product.notes.text2}</p>
  </div>

  <LineBreak />

  <!-- Отзывы -->
  <div class="flex justify-between items-center">
    <p class="font-semibold">{product.reviews.title}</p>
    <div class="text-right">
      <div class="flex items-center gap-1">
        <StarIcon class="fill-[#fffc00] size-4" />
        <span>{product.reviews.review}</span>
      </div>
      <p class="text-xs text-[#666]">{product.reviews.score}</p>
    </div>
  </div>

  <div class="card__item my-5 shadow-md rounded-lg p-2">
    <p class="text-xs">{product.reviews.date}</p>
    <div class="flex justify-end mt-1">
      <div class="flex items-center gap-2 border border-[#008d49] rounded-full px-2 py-1 text-xs">
        <CircleCheckIcon class="size-4 fill-[#00a445] text-white" />
        <span>{product.reviews.textConfirm}</span>
      </div>
    </div>
    <p class="text-sm mt-1">{product.reviews.author}</p>
    <div class="flex justify-between items-center mt-3 text-[#4d4d4d]">
      <div class="flex items-center gap-1">
        <Image src={ThumbOffIcon} alt="Like Icon" />
        <span class="text-xs">{product.reviews.quantityPeople}</span>
      </div>
      <DotsIcon />
    </div>
  </div>

  <button class="border-2 border-[#01A444] bg-[#008D49] text-white text-sm rounded-xl py-1 font-bold w-full">
    {product.reviews.btnTitle}
  </button>

  <LineBreak />

  <!-- Вопрос -->
  <section class="my-5">
    <h5 class="font-semibold">{product.question.title}</h5>
    <p class="text-[#444] px-4">
      {product.question.text.oneChunk} <span class="text-[#d05] italic">{product.question.text.twoChunk}</span> {product.question.text.threeChunk}
      <span class="font-bold text-orange-400"> {product.question.text.forChunk}</span>
    </p>
    <!-- Comment -->
    <div class="flex gap-3 mt-4">
      <div class="w-1.5 h-32 bg-[#008D49]" />
      <div class="flex flex-col gap-2">
        <p class="italic font-bold">
          {product.comment.author} <span class="text-[#999] text-xs">{product.comment.date}</span>
        </p>
        <p class="text-xs">{product.comment.text}</p>
        <button class="bg-[#00a445] text-white text-sm px-4 py-1 rounded-md w-max cursor-pointer">{product.comment.btnTitle}</button>
      </div>
    </div>
  </section>
</main>